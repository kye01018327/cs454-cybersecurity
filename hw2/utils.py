# AES S-Boxes
S_BOX = [
    [99, 124, 119, 123, 242, 107, 111, 197, 48, 1, 103, 43, 254, 215, 171, 118],
    [202, 130, 201, 125, 250, 89, 71, 240, 173, 212, 162, 175, 156, 164, 114, 192],
    [183, 253, 147, 38, 54, 63, 247, 204, 52, 165, 229, 241, 113, 216, 49, 21],
    [4, 199, 35, 195, 24, 150, 5, 154, 7, 18, 128, 226, 235, 39, 178, 117],
    [9, 13, 207, 180, 75, 76, 51, 196, 22, 136, 149, 16, 217, 127, 225, 232],
    [144, 105, 68, 15, 10, 198, 209, 230, 19, 172, 159, 188, 145, 11, 62, 193],
    [233, 255, 208, 133, 176, 160, 245, 246, 219, 74, 120, 104, 101, 110, 80, 190],
    [78, 231, 1, 2, 42, 65, 189, 234, 108, 112, 122, 194, 251, 186, 17, 131],
    [46, 181, 116, 37, 25, 34, 191, 184, 84, 50, 166, 203, 100, 185, 237, 26],
    [27, 249, 44, 174, 30, 153, 252, 163, 211, 244, 200, 2, 14, 227, 146, 148],
    [228, 135, 96, 248, 141, 64, 157, 129, 238, 91, 102, 23, 158, 28, 187, 140],
    [210, 182, 15, 236, 134, 106, 218, 92, 243, 177, 6, 213, 3, 85, 93, 151],
    [214, 18, 138, 143, 168, 55, 67, 41, 25, 155, 97, 33, 239, 121, 0, 170],
    [95, 124, 24, 60, 152, 53, 32, 57, 169, 73, 20, 88, 137, 47, 231, 94],
    [109, 139, 87, 223, 77, 82, 61, 59, 161, 1, 132, 142, 79, 224, 66, 106],
    [25, 5, 29, 36, 19, 220, 3, 222, 16, 115, 15, 30, 25, 14, 12, 12]
]

# Functions
def printb(block: list[list[int]]) -> None:
    for row in block:
        print("[", end="")
        for byte in row:
            print(hex(byte), end=" ")
        print("]")
    print()


def convert_int_to_block(input: int) -> list: 
    total_bytes = 16 
    block = []
    for i in range(4):
        row = []
        for j in range(4):
            byte_index = total_bytes - 1 - (i * 4 + j)
            shift_amount = byte_index * 8
            byte = (input >> shift_amount) & 0xff
            row.append(byte)
        block.append(row)
    return block

def convert_block_to_int(block: list[list[int]]) -> int:
    total_bytes = 16 
    output_int = 0
    for i in range(4):
        for j in range(4):
            byte = block[i][j]
            byte_index = total_bytes - 1 - (i * 4 + j)
            shift_amount = byte_index * 8
            output_int |= (byte << shift_amount)
    return output_int