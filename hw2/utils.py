# Test data
plaintext = 0x00112233445566778899aabbccddeeff
key = 0x000102030405060708090a0b0c0d0e0f


# AES tables
S_BOX = [
    [99, 124, 119, 123, 242, 107, 111, 197, 48, 1, 103, 43, 254, 215, 171, 118],
    [202, 130, 201, 92, 253, 59, 47, 0, 211, 236, 68, 174, 198, 87, 57, 212],
    [233, 252, 178, 29, 101, 75, 251, 2, 227, 245, 128, 243, 250, 15, 20, 93],
    [86, 100, 19, 62, 169, 179, 137, 229, 181, 191, 74, 240, 163, 160, 89, 237],
    [255, 106, 149, 143, 222, 194, 76, 117, 31, 234, 135, 84, 177, 214, 145, 96],
    [5, 176, 152, 164, 125, 134, 173, 116, 167, 199, 109, 146, 14, 218, 127, 220],
    [232, 6, 190, 141, 162, 160, 235, 175, 41, 60, 246, 217, 17, 25, 53, 195],
    [189, 12, 44, 63, 104, 106, 4, 213, 223, 85, 238, 161, 249, 228, 97, 244],
    [153, 11, 79, 98, 179, 199, 57, 252, 104, 255, 170, 77, 242, 60, 18, 154],
    [205, 9, 169, 195, 204, 196, 249, 136, 26, 118, 125, 230, 242, 178, 205, 170],
    [251, 63, 56, 14, 218, 139, 152, 94, 234, 99, 211, 171, 184, 101, 10, 176],
    [130, 225, 184, 246, 25, 129, 148, 193, 21, 89, 248, 59, 242, 92, 18, 50],
    [121, 248, 134, 122, 231, 109, 163, 253, 27, 227, 235, 254, 213, 113, 224, 190],
    [210, 15, 178, 165, 107, 7, 206, 108, 10, 222, 153, 145, 238, 154, 103, 194],
    [182, 162, 227, 201, 193, 239, 212, 116, 243, 50, 215, 228, 130, 20, 160, 84],
    [100, 209, 216, 12, 224, 214, 24, 196, 44, 118, 49, 173, 20, 224, 125, 212]
]

M = [
    [0x02, 0x03, 0x01, 0x01],
    [0x01, 0x02, 0x03, 0x01],
    [0x01, 0x01, 0x02, 0x03],
    [0x03, 0x01, 0x01, 0x02]
]

# Functions
def printb(block: list[list[int]]) -> None:
    for row in block:
        print("[", end="")
        for byte in row:
            print(hex(byte), end=" ")
        print("]")
    print()


def convert_int_to_matrix(input: int) -> list: 
    matrix = []
    for i in range(4):
        row = []
        for j in range(4):
            shift_amount = (15 - (i + 4 * j)) * 8
            row.append((input >> shift_amount) & 0xff)
        matrix.append(row)
    return matrix

def convert_matrix_to_int(matrix: list[list[int]]) -> int:
    output_int = 0
    for i in range(4):
        for j in range(4):
            shift_amount = (15 - (i + 4 * j)) * 8
            output_int |= (matrix[i][j] << shift_amount)
    return output_int
